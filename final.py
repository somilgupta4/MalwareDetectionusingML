
import pandas as pd
from sklearn.ensemble import ExtraTreesClassifier
from sklearn.feature_selection import SelectFromModel
from sklearn.model_selection import train_test_split
from sklearn.model_selection import cross_validate
from sklearn.ensemble import GradientBoostingClassifier
from sklearn.ensemble import RandomForestClassifier

malData=pd.read_csv("C:/Users/parsh/Desktop/MalwareData.csv", sep="|")

begn=malData[0:41323].drop(["legitimate"],axis=1)
mal=malData[41323::].drop(["legitimate"],axis=1)

data_in=malData.drop(['Name', 'md5', 'legitimate'], axis=1).values
labels=malData['legitimate'].values
extratrees=ExtraTreesClassifier().fit(data_in,labels)
select=SelectFromModel(extratrees,prefit=True)
data_new=select.transform(data_in)

begn_train, begn_test, mal_train, mal_test=train_test_split(data_new, labels, test_size=0.2)

classif = RandomForestClassifier(n_estimators=50)
classif.fit(begn_train,mal_train)
print("The accuracy of Random Forest Classifier on the dataset is: ",classif.score(begn_test,mal_test)*100)

grad_boost=GradientBoostingClassifier(n_estimators=50)
grad_boost.fit(begn_train,mal_train)
print(grad_boost.score(begn_test,mal_test)*100)